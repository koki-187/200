# 未構築タスク一覧 (v3.86.2以降)

## 📅 更新日時
2025-12-01 16:45 UTC

## 🎯 概要
このドキュメントは、200棟土地仕入れ管理システム v3.86.2 以降で未実装または改善が必要な機能・タスクをまとめたものです。

---

## 🔴 高優先度タスク (実装推奨)

### 1. ユーザー管理API実装
- **現状**: `/api/users/:id` が 404 Not Found
- **必要な実装**:
  - ユーザー情報取得API (`GET /api/users/:id`)
  - ユーザー一覧取得API (`GET /api/users`)
  - ユーザー更新API (`PUT /api/users/:id`)
  - ユーザー削除API (`DELETE /api/users/:id`)
- **推定工数**: 2-3時間
- **影響**: ユーザープロファイル表示、ユーザー管理機能が使用不可
- **対応方針**: 
  ```typescript
  // src/routes/users.ts を作成
  // - 認証ミドルウェア統合
  // - RBAC (Role-Based Access Control) 実装
  // - パスワード変更機能
  ```

### 2. ファイル一覧API修正
- **現状**: `/api/files?dealId=xxx` が 404 Not Found または正常動作しない
- **必要な実装**:
  - ファイル一覧取得の修正
  - クエリパラメータ対応 (dealId, category, userId)
  - ページネーション実装
- **推定工数**: 1-2時間
- **影響**: ファイル管理機能の一部が使用不可
- **対応方針**:
  ```typescript
  // src/routes/files.ts の GET / エンドポイント確認
  // - クエリパラメータのパース
  // - データベースクエリの修正
  ```

### 3. OpenAI APIキー設定手順の簡素化
- **現状**: `OPENAI_API_KEY_SETUP.md` を参照する必要がある
- **必要な実装**:
  - 管理画面でのAPIキー設定UI
  - 環境変数の動的更新
  - APIキーの検証機能
- **推定工数**: 2-4時間
- **影響**: OCR機能、AI提案機能が使用不可
- **対応方針**:
  ```typescript
  // 管理画面に「API設定」タブを追加
  // - OpenAI API Key入力フォーム
  // - テストAPI呼び出しボタン
  // - 設定保存・更新機能
  ```

---

## 🟡 中優先度タスク (改善推奨)

### 4. Rate Limit設定の最適化
- **現状**: 開発環境で頻繁にログインすると 429 Too Many Requests
- **必要な実装**:
  - 開発環境用のRate Limit緩和
  - ユーザーロール別のRate Limit設定
  - Rate Limit超過時のエラーメッセージ改善
- **推定工数**: 1-2時間
- **影響**: 開発効率の低下
- **対応方針**:
  ```typescript
  // src/middleware/rate-limit.ts
  // - 環境変数でRate Limit値を調整
  // - 開発環境: 1000 req/window
  // - 本番環境: 100 req/window
  ```

### 5. エラーレスポンスの統一化
- **現状**: 404エラーが "404 Not Found" のプレーンテキスト
- **必要な実装**:
  - 統一されたエラーレスポンス形式
  - エラーコード体系の整備
  - 多言語対応のエラーメッセージ
- **推定工数**: 2-3時間
- **影響**: ユーザーエクスペリエンスの低下
- **対応方針**:
  ```typescript
  // 統一エラーレスポンス形式:
  {
    "error": {
      "code": "USER_NOT_FOUND",
      "message": "ユーザーが見つかりません",
      "details": "指定されたユーザーIDは存在しません",
      "timestamp": "2025-12-01T16:45:00Z"
    }
  }
  ```

### 6. テストカバレッジの拡大
- **現状**: 手動テストのみ、自動テスト未実装
- **必要な実装**:
  - Vitest によるユニットテスト
  - Playwright による E2E テスト
  - CI/CD パイプラインへの統合
- **推定工数**: 1週間
- **影響**: バグの早期発見が困難
- **対応方針**:
  ```bash
  # テストフレームワーク導入
  npm install -D vitest @vitest/ui playwright @playwright/test
  
  # テストファイル作成
  # - src/routes/__tests__/deals.test.ts
  # - src/routes/__tests__/messages.test.ts
  # - e2e/auth.spec.ts
  # - e2e/deals.spec.ts
  ```

### 7. ログイン機能の拡張
- **現状**: メール・パスワードのみ
- **必要な実装**:
  - Google OAuth ログイン
  - Microsoft OAuth ログイン
  - 2要素認証 (2FA)
  - パスワードリセット機能
- **推定工数**: 1週間
- **影響**: セキュリティ、ユーザビリティの向上
- **対応方針**:
  ```typescript
  // OAuth プロバイダー統合
  // - Cloudflare Access 統合
  // - Auth0 統合検討
  // - TOTP (Time-based One-Time Password) 実装
  ```

---

## 🟢 低優先度タスク (将来的な改善)

### 8. パフォーマンス最適化
- **現状**: バンドルサイズ 944KB
- **必要な実装**:
  - コード分割の徹底
  - 不要な依存関係の削除
  - Tree Shaking の最適化
  - CDN統合の見直し
- **推定工数**: 3-5日
- **影響**: ページ読み込み速度の向上
- **目標**: バンドルサイズ < 500KB

### 9. ドキュメント整備
- **現状**: API仕様書が不完全
- **必要な実装**:
  - OpenAPI (Swagger) 仕様書の作成
  - API使用例の追加
  - エラーケースのドキュメント化
  - 開発者向けガイドの拡充
- **推定工数**: 1週間
- **影響**: 開発効率、保守性の向上

### 10. セキュリティ監査
- **現状**: 基本的なセキュリティ対策は実装済み
- **必要な実装**:
  - OWASP Top 10 チェック
  - 依存関係の脆弱性スキャン
  - ペネトレーションテスト
  - セキュリティヘッダーの最適化
- **推定工数**: 1週間
- **影響**: セキュリティレベルの向上

### 11. モバイルアプリ化
- **現状**: Webアプリケーションのみ
- **必要な実装**:
  - PWA (Progressive Web App) 化
  - プッシュ通知対応
  - オフラインモード強化
  - ホーム画面追加機能
- **推定工数**: 2週間
- **影響**: モバイル UX の向上

### 12. データ分析ダッシュボード
- **現状**: 基本的な統計情報のみ
- **必要な実装**:
  - 案件の傾向分析
  - 売上予測モデル
  - 地域別分析
  - エージェント別パフォーマンス分析
- **推定工数**: 2-3週間
- **影響**: ビジネスインサイトの向上

---

## 📋 既知の制約事項

### 1. Cloudflare Pages の制限
- Workers の実行時間制限 (CPU time: 50ms)
- D1 Database のクエリ制限
- R2 Storage のバンドル制限

### 2. OpenAI API依存
- OCR機能が OpenAI API に依存
- API料金の発生
- レート制限の考慮が必要

### 3. フロントエンドの制約
- SPAのため、初回読み込みが遅い可能性
- SEO対策が限定的
- SSR (Server-Side Rendering) 未実装

---

## 🎯 次のチャットで実装すべき推奨タスク

### すぐに実装できるタスク (1-3時間)
1. **ユーザー管理API実装** (2-3時間)
   - `/api/users/:id` GET/PUT/DELETE
   - 認証・認可の統合
2. **ファイル一覧API修正** (1-2時間)
   - クエリパラメータ対応
   - エラーハンドリング改善

### 中期的に実装するタスク (1日-1週間)
3. **OpenAI APIキー設定UI** (2-4時間)
4. **Rate Limit最適化** (1-2時間)
5. **テストカバレッジ拡大** (1週間)

### 長期的に実装するタスク (1週間以上)
6. **ログイン機能拡張** (1週間)
7. **パフォーマンス最適化** (3-5日)
8. **モバイルアプリ化** (2週間)

---

## 📝 備考

このドキュメントは定期的に更新してください。
新しいタスクが発生した場合は、優先度と推定工数を記載して追加してください。

**最終更新**: v3.86.2 (2025-12-01 16:45 UTC)
