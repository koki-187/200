#!/usr/bin/env python3
"""
ChatGPT提供の自治体リストと既存DBを比較し、未統合自治体を抽出
"""

import csv

# ChatGPT提供の自治体リスト（CSVから）
CHATGPT_MUNICIPALITIES = [
    ('神奈川県', '横浜市'),
    ('神奈川県', '川崎市'),
    ('神奈川県', '相模原市'),
    ('神奈川県', '横須賀市'),
    ('神奈川県', '平塚市'),
    ('神奈川県', '鎌倉市'),
    ('神奈川県', '藤沢市'),
    ('神奈川県', '小田原市'),
    ('神奈川県', '茅ヶ崎市'),
    ('神奈川県', '逗子市'),
    ('神奈川県', '三浦市'),
    ('神奈川県', '秦野市'),
    ('神奈川県', '厚木市'),
    ('神奈川県', '大和市'),
    ('神奈川県', '伊勢原市'),
    ('神奈川県', '海老名市'),
    ('神奈川県', '座間市'),
    ('千葉県', '千葉市'),
    ('千葉県', '市川市'),
    ('千葉県', '船橋市'),
    ('千葉県', '松戸市'),
    ('千葉県', '柏市'),
    ('千葉県', '野田市'),
    ('千葉県', '習志野市'),
    ('千葉県', '流山市'),
    ('千葉県', '八千代市'),
    ('千葉県', '市原市'),
    ('千葉県', '佐倉市'),
    ('埼玉県', 'さいたま市'),
    ('埼玉県', '川口市'),
    ('埼玉県', '川越市'),
    ('埼玉県', '越谷市'),
    ('埼玉県', '草加市'),
    ('埼玉県', '所沢市'),
    ('埼玉県', '熊谷市'),
    ('埼玉県', '春日部市'),
    ('埼玉県', '上尾市'),
    ('埼玉県', '戸田市'),
    ('埼玉県', '蕨市'),
    ('埼玉県', '朝霞市'),
    ('埼玉県', '和光市'),
    ('埼玉県', '新座市'),
    ('埼玉県', '久喜市'),
]

# 既存VERIFIED自治体（市区町村レベルのみ、区データは除外）
EXISTING_VERIFIED = [
    ('千葉県', '千葉市'),
    ('千葉県', '市川市'),
    ('千葉県', '松戸市'),
    ('千葉県', '柏市'),
    ('千葉県', '船橋市'),
    ('千葉県', '野田市'),
    ('埼玉県', 'さいたま市'),
    ('埼玉県', '川口市'),
    ('埼玉県', '所沢市'),
    ('埼玉県', '草加市'),
    ('埼玉県', '八潮市'),
    ('埼玉県', '幸手市'),
    ('東京都', '三鷹市'),
    ('東京都', '世田谷区'),
    ('東京都', '中央区'),
    ('東京都', '八王子市'),
    ('東京都', '北区'),
    ('東京都', '千代田区'),
    ('東京都', '品川区'),
    ('東京都', '墨田区'),
    ('東京都', '大田区'),
    ('東京都', '府中市'),
    ('東京都', '新宿区'),
    ('東京都', '板橋区'),
    ('東京都', '武蔵野市'),
    ('東京都', '江戸川区'),
    ('東京都', '江東区'),
    ('東京都', '渋谷区'),
    ('東京都', '町田市'),
    ('東京都', '目黒区'),
    ('東京都', '立川市'),
    ('東京都', '葛飾区'),
    ('東京都', '足立区'),
    ('神奈川県', '大和市'),
    ('神奈川県', '川崎市'),
    ('神奈川県', '横須賀市'),
    ('神奈川県', '相模原市'),
    ('神奈川県', '茅ヶ崎市'),
    ('神奈川県', '藤沢市'),
    ('神奈川県', '逗子市'),
    ('神奈川県', '鎌倉市'),
]

def analyze_missing():
    """未統合自治体を抽出"""
    existing_set = set(EXISTING_VERIFIED)
    chatgpt_set = set(CHATGPT_MUNICIPALITIES)
    
    # 未統合自治体
    missing = chatgpt_set - existing_set
    
    # 県別に集計
    by_prefecture = {}
    for pref, city in sorted(missing):
        if pref not in by_prefecture:
            by_prefecture[pref] = []
        by_prefecture[pref].append(city)
    
    print("## 📋 未統合自治体リスト（ChatGPT提供 - 既存DB）\n")
    
    total = 0
    for pref, cities in sorted(by_prefecture.items()):
        print(f"### {pref}（{len(cities)}自治体）")
        for i, city in enumerate(cities, 1):
            print(f"{i}. {city}")
        print()
        total += len(cities)
    
    print(f"**合計**: {total}自治体が未統合\n")
    
    # 統合済み確認
    already_done = chatgpt_set & existing_set
    print(f"## ✅ 既に統合済み（ChatGPT提供リスト内）: {len(already_done)}自治体\n")
    for pref, city in sorted(already_done):
        print(f"- {pref} {city}")

if __name__ == '__main__':
    analyze_missing()
