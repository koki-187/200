# 最終ユーザーテストガイド - v3.39.0

## 🎯 テスト目的
Phase 2で修正したすべての機能が本番環境で正常に動作することを確認します。

---

## 🌐 本番環境URL
**Production URL**: https://6c17d177.real-estate-200units-v2.pages.dev

---

## 🔐 ログイン情報

### 管理者アカウント
- **メールアドレス**: `navigator-187@docomo.ne.jp`
- **パスワード**: `kouki187`
- **ロール**: ADMIN（管理者）

### 売側ユーザー1
- **メールアドレス**: `seller1@example.com`
- **パスワード**: `agent123`
- **ロール**: AGENT（売側）

---

## 📋 テスト項目

### ✅ **テスト1: ログイン機能**

#### 手順
1. https://6c17d177.real-estate-200units-v2.pages.dev/ にアクセス
2. メールアドレス: `navigator-187@docomo.ne.jp`
3. パスワード: `kouki187`
4. 「ログイン」ボタンをクリック

#### 期待される結果
- ✅ ログインが成功し、ダッシュボードにリダイレクトされる
- ✅ 右上にユーザー名「管理者」が表示される
- ✅ コンソールエラー（F12）が発生しない

#### 確認事項
- [ ] ログイン成功
- [ ] ダッシュボード表示
- [ ] ユーザー名表示
- [ ] コンソールエラーなし

---

### ✅ **テスト2: 案件詳細ページ（無限ローディング問題の修正確認）**

#### 手順
1. ダッシュボードから「案件一覧」をクリック
2. または直接 https://6c17d177.real-estate-200units-v2.pages.dev/deals にアクセス
3. 案件「川崎市幸区塚越四丁目 アパート用地」をクリック
4. または直接 https://6c17d177.real-estate-200units-v2.pages.dev/deals/deal-001 にアクセス

#### 期待される結果
- ✅ ページが正常に読み込まれる（無限ローディングしない）
- ✅ 案件詳細情報が表示される
- ✅ 地図が表示される
- ✅ タブ（基本情報、AI提案、ファイル、メッセージ）が機能する
- ✅ JavaScriptエラーが発生しない

#### デバッグログ確認（F12 コンソール）
以下のログが表示されることを確認：
```
[Deal Detail] Window load event fired
[Deal Detail] User name displayed: 管理者
[Deal Detail] Loading deal: deal-001
[Deal Detail] API response received: {...}
[Deal Detail] Deal displayed successfully
[Deal Detail] Message attachment listener registered
```

#### 確認事項
- [ ] ページが正常に読み込まれる
- [ ] 案件詳細情報が表示される
- [ ] 地図が表示される（Leaflet.js）
- [ ] タブ切り替えが動作する
- [ ] デバッグログが正常に出力される
- [ ] JavaScriptエラーなし

---

### ✅ **テスト3: OCRファイルアップロード機能**

#### 手順
1. ダッシュボードから「新規案件作成」をクリック
2. または直接 https://6c17d177.real-estate-200units-v2.pages.dev/deals/new にアクセス
3. 「OCR自動入力」セクションまでスクロール
4. 「ファイルを選択またはドラッグ＆ドロップ」ボタンをクリック
5. 画像ファイル（PNG、JPG）またはPDFファイルを選択
6. ファイルアップロード後の動作を確認

#### 期待される結果
- ✅ ファイル選択ダイアログが開く
- ✅ ファイル選択後、プレビューが表示される
- ✅ OCR処理が開始される（プログレスバー表示）
- ✅ OCR結果が「OCR抽出完了」セクションに表示される
- ✅ 「フォームに適用」ボタンで入力フォームに反映される
- ✅ JavaScriptエラーが発生しない

#### デバッグログ確認（F12 コンソール）
以下のログが表示されることを確認：
```
[Event Delegation] File input changed
[Event Delegation] Files selected: 1
processMultipleOCR called (グローバル関数として正常に呼び出される)
```

#### 確認事項
- [ ] ファイル選択ダイアログが開く
- [ ] ファイルプレビューが表示される
- [ ] OCR処理が開始される
- [ ] プログレスバーが表示される
- [ ] OCR結果が表示される
- [ ] フォームに自動入力される
- [ ] JavaScriptエラーなし

#### 注意事項
- **OCR処理にはOpenAI APIキーが必要です**。環境変数 `OPENAI_API_KEY` が設定されていない場合、エラーが発生する可能性があります。
- エラーメッセージが表示される場合は、管理者に環境変数設定を依頼してください。

---

### ✅ **テスト4: テンプレート選択機能**

#### 手順
1. 案件作成ページ（https://6c17d177.real-estate-200units-v2.pages.dev/deals/new）にアクセス
2. 「テンプレートから入力」セクションの「テンプレート選択」ボタンをクリック
3. モーダルが表示されることを確認
4. テンプレート一覧を確認
5. テンプレートをクリックして選択
6. フォームに自動入力されることを確認

#### 期待される結果
- ✅ 「テンプレート選択」ボタンクリックでモーダルが表示される
- ✅ テンプレート一覧が読み込まれる
- ✅ プリセットテンプレート（4種類）が表示される
  - 住宅用地（標準）
  - マンション用地（200棟向け）
  - 商業用地
  - 投資用地（高利回り）
- ✅ テンプレート選択でフォームに自動入力される
- ✅ JavaScriptエラーが発生しない

#### デバッグログ確認（F12 コンソール）
以下のログが表示されることを確認：
```
[Event Delegation] Template select button clicked
openTemplateModal called (グローバル関数として正常に呼び出される)
テンプレート読み込み成功
```

#### 確認事項
- [ ] 「テンプレート選択」ボタンが機能する
- [ ] モーダルが表示される
- [ ] テンプレート一覧が読み込まれる
- [ ] プリセットテンプレートが4種類表示される
- [ ] テンプレート選択でフォームに自動入力される
- [ ] JavaScriptエラーなし

---

### ✅ **テスト5: OCR履歴・設定ボタン**

#### 手順
1. 案件作成ページ（https://6c17d177.real-estate-200units-v2.pages.dev/deals/new）にアクセス
2. OCRセクションの「履歴」ボタンをクリック
3. OCR履歴モーダルが表示されることを確認
4. モーダルを閉じる
5. 「設定」ボタンをクリック
6. OCR設定モーダルが表示されることを確認

#### 期待される結果
- ✅ 「履歴」ボタンクリックでモーダルが表示される
- ✅ 「設定」ボタンクリックでモーダルが表示される
- ✅ モーダル内の設定項目が表示される
  - バッチサイズ（最大10）
  - 信頼度しきい値
  - 自動適用
- ✅ JavaScriptエラーが発生しない

#### 確認事項
- [ ] 「履歴」ボタンが機能する
- [ ] OCR履歴モーダルが表示される
- [ ] 「設定」ボタンが機能する
- [ ] OCR設定モーダルが表示される
- [ ] 設定項目が正しく表示される
- [ ] JavaScriptエラーなし

---

### ✅ **テスト6: 買取条件チェックリストページ**

#### 手順
1. ダッシュボードから「買取条件」をクリック
2. または直接 https://6c17d177.real-estate-200units-v2.pages.dev/purchase-criteria にアクセス
3. ページが正常に表示されることを確認

#### 期待される結果
- ✅ ページが正常に読み込まれる
- ✅ 買取条件一覧が表示される
- ✅ 自動採点システムが表示される
- ✅ JavaScriptエラーが発生しない

#### 確認事項
- [ ] ページが正常に読み込まれる
- [ ] 買取条件一覧が表示される
- [ ] 自動採点システムが機能する
- [ ] JavaScriptエラーなし

---

## 🐛 エラーが発生した場合

### コンソールログの確認方法
1. ブラウザでF12キーを押す（または右クリック → 検証）
2. 「Console」タブをクリック
3. 赤いエラーメッセージを確認
4. スクリーンショットを撮影
5. エラーメッセージをコピー

### 報告方法
エラーが発生した場合は、以下の情報を記録してください：
- **テスト番号**: （例: テスト2）
- **エラーメッセージ**: （コンソールからコピー）
- **スクリーンショット**: （ページ全体とコンソール）
- **再現手順**: （何をしたらエラーが発生したか）

---

## ✅ テスト完了後の確認

すべてのテストが完了したら、以下のチェックリストを確認してください：

- [ ] テスト1: ログイン機能 ✅
- [ ] テスト2: 案件詳細ページ ✅
- [ ] テスト3: OCRファイルアップロード ✅
- [ ] テスト4: テンプレート選択 ✅
- [ ] テスト5: OCR履歴・設定 ✅
- [ ] テスト6: 買取条件チェックリスト ✅

---

## 📊 期待される結果

### すべてのテストが成功した場合
- ✅ Phase 2の修正が完全に動作している
- ✅ すべての重大バグが解決されている
- ✅ 本番環境で問題なく使用できる状態

### 一部のテストが失敗した場合
- ⚠️ エラー内容を記録し、開発者に報告
- ⚠️ Phase 3で追加修正が必要

---

## 🔗 関連URL

- **Production URL**: https://6c17d177.real-estate-200units-v2.pages.dev
- **Login**: https://6c17d177.real-estate-200units-v2.pages.dev/
- **Deal Creation (OCR)**: https://6c17d177.real-estate-200units-v2.pages.dev/deals/new
- **Deal Detail**: https://6c17d177.real-estate-200units-v2.pages.dev/deals/deal-001
- **Purchase Criteria**: https://6c17d177.real-estate-200units-v2.pages.dev/purchase-criteria
- **API Docs**: https://6c17d177.real-estate-200units-v2.pages.dev/api/docs

---

## 📞 サポート

テスト中に問題が発生した場合は、以下の情報を提供してください：
1. テスト番号
2. エラーメッセージ（コンソールログ）
3. スクリーンショット
4. 再現手順

---

**テストガイド作成日**: 2025-11-25  
**バージョン**: v3.39.0  
**作成者**: AI Assistant

---

**重要**: このテストガイドは、Phase 2で修正したすべての機能を検証するためのものです。すべてのテストを完了し、結果を記録してください。
